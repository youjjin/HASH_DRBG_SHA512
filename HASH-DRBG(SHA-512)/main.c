#include "HASH-DRBG(SHA-512).h"
#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>
#include <string.h>
#include <assert.h>


unsigned int cpucycles(void) { return __rdtsc(); }


void main()
{
	STATE state;
	state.state_control.prediction_resistance_flag = 1;

	unsigned char Entropy[32] = { 0xAA, 0xF7, 0xD5, 0xD7, 0x32, 0x6E, 0x84, 0xD3, 0x61, 0xB8, 0x5B, 0x68, 0x91, 0x9B, 0x9F, 0x18, 0x4E, 0x3D, 0x6C, 0xE0, 0xB0, 0x2B, 0xA6, 0x5F, 0xE7, 0xA0, 0x31, 0x3B, 0x18, 0x05, 0x65, 0xC1 };
	unsigned char Nonce[16] = { 0x68, 0xB4, 0xBC, 0xCB, 0x56, 0x01, 0xCE, 0xE7, 0x4D, 0x7B, 0x80, 0xB5, 0x79, 0x6F, 0x78, 0x91 };
	unsigned char* PersonalizationString = NULL;
	unsigned char Entropy1[32] = { 0xDB, 0xAE, 0xD4, 0x72, 0x98, 0x90, 0x1B, 0x12, 0x97, 0x39, 0x73, 0x50, 0x4A, 0x1B, 0x15, 0xD2, 0xCC, 0xBC, 0xFF, 0xEE, 0x2D, 0xBA, 0xE8, 0xCB, 0x0A, 0x0C, 0x79, 0xC3, 0x60, 0x8A, 0xBA, 0x0C };
	unsigned char* Additional1 = NULL;
	unsigned char Entropy2[32] = { 0xA1, 0xB0, 0xCB, 0x98, 0x08, 0x9F, 0xD4, 0x39, 0x2A, 0x64, 0x3E, 0x09, 0xCF, 0x7D, 0x24, 0x09, 0xFF, 0x99, 0x04, 0x08, 0x60, 0xA0, 0xBB, 0xC7, 0xBF, 0xF3, 0xB0, 0x5A, 0xEC, 0xF5, 0x4F, 0xD1 };
	unsigned char* Additional2 = NULL;

	unsigned char randombits[256] = { 0x00, };

	int i;
	unsigned long long cycles = 0;
	unsigned long long cycles1 = 0;
	unsigned long long cycles2 = 0;
	unsigned int loop = 10000;

	//for loop에 들어가는 것까지 안새주려고 시간을 포루프 안에서 돌려줄것이다.
	for (i = 0; i < loop; i++)
	{
		cycles1 = cpucycles();

		Hash_DRBG_SHA512_yes_op(&state, Entropy, 32, Entropy1, 32, Entropy2, 32, Nonce, 16, PersonalizationString, 0, Additional1, 0, Additional2, 0, randombits);

		cycles2 = cpucycles();
		cycles += (cycles2 - cycles1);
	}

	printf("\n[loop = %d]cycles : %10lld\n", loop, cycles / loop);
	cycles = 0;


	printf("[난수]\n");
	for (int A = 0; A < 256; A++)
		printf("%02X ", randombits[A]);
	printf("\n");

	//Hash_DRBG_SHA512_usePR_Test(); // 1901695
	//Hash_DRBG_SHA512_noPR_Test(); //CB4E5B
}